<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»å½±è³‡è¨ŠæŸ¥è©¢ - å¨å®‡å½±åŸ</title>
    <link rel="stylesheet" href="/WeiYuCinema/static/css/style.css">
</head>
<body>
    <!-- é é¦–ä½”ä½ç¬¦ -->
    <div id="header-placeholder"></div>
    
    <!-- ä¸»è¦å…§å®¹ -->
    <div class="container">
        <div class="page-title">
            <h1>é›»å½±è³‡è¨ŠæŸ¥è©¢</h1>
            <p>æ¢ç´¢æœ€æ–°é›»å½±è³‡è¨Š</p>
        </div>
        
        <!-- æœå°‹èˆ‡ç¯©é¸ -->
        <div class="section-box">
            <h2 class="section-title">ğŸ” æœå°‹é›»å½±</h2>
            <form method="GET" action="">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="keyword">é—œéµå­—æœå°‹</label>
                        <input type="text" id="keyword" name="keyword" value="<?php echo htmlspecialchars($searchKeyword); ?>" placeholder="é›»å½±åç¨±ã€å°æ¼”ã€æ¼”å“¡">
                    </div>
                    
                    <div class="form-group">
                        <label for="grade">åˆ†ç´šç¯©é¸</label>
                        <select id="grade" name="grade">
                            <option value="">å…¨éƒ¨åˆ†ç´š</option>
                            <?php while ($grade = mysqli_fetch_assoc($gradeList)): ?>
                                <option value="<?php echo $grade['gradeId']; ?>" 
                                        <?php echo ($filterGrade == $grade['gradeId']) ? 'selected' : ''; ?>>
                                    <?php echo htmlspecialchars($grade['gradeName']); ?>
                                </option>
                            <?php endwhile; ?>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="type">é¡å‹ç¯©é¸</label>
                        <select id="type" name="type">
                            <option value="">å…¨éƒ¨é¡å‹</option>
                            <?php while ($type = mysqli_fetch_assoc($typeList)): ?>
                                <option value="<?php echo $type['movieTypeId']; ?>" 
                                        <?php echo ($filterType == $type['movieTypeId']) ? 'selected' : ''; ?>>
                                    <?php echo htmlspecialchars($type['movieTypeName']); ?>
                                </option>
                            <?php endwhile; ?>
                        </select>
                    </div>
                </div>
                
                <div class="text-center">
                    <button type="submit" class="btn btn-primary" style="margin-right: 10px;">ğŸ” æœå°‹</button>
                    <button type="button" class="btn btn-secondary" onclick="location.href='movies.php'">æ¸…é™¤ç¯©é¸</button>
                </div>
            </form>
        </div>
        
        <!-- é›»å½±åˆ—è¡¨ -->
        <div class="section-box">
            <h2 class="section-title">ğŸ¬ é›»å½±åˆ—è¡¨</h2>
            
            <?php if (mysqli_num_rows($result) > 0): ?>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; margin-top: 20px;">
                    <?php while ($movie = mysqli_fetch_assoc($result)): ?>
                        <div class="movie-card" style="background: #2c2c2c; border-radius: 12px; overflow: hidden; transition: transform 0.3s, box-shadow 0.3s;">
                            <div class="movie-poster" style="height: 400px; overflow: hidden; position: relative;">
                                <?php if (!empty($movie['movieImg'])): ?>
                                    <img src="/WeiYuCinema/images/movies/<?php echo htmlspecialchars($movie['movieImg']); ?>" 
                                         alt="<?php echo htmlspecialchars($movie['movieName']); ?>" 
                                         style="width: 100%; height: 100%; object-fit: cover;">
                                <?php else: ?>
                                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 18px;">
                                        ğŸ¬<br>æš«ç„¡æµ·å ±
                                    </div>
                                <?php endif; ?>
                                
                                <div class="movie-grade" style="position: absolute; top: 10px; right: 10px; background: var(--primary-color); color: #000; padding: 5px 10px; border-radius: 15px; font-weight: bold; font-size: 12px;">
                                    <?php echo htmlspecialchars($movie['gradeName']); ?>
                                </div>
                            </div>
                            
                            <div class="movie-info" style="padding: 20px;">
                                <h3 style="margin: 0 0 10px 0; color: var(--primary-color); font-size: 18px;">
                                    <?php echo htmlspecialchars($movie['movieName']); ?>
                                </h3>
                                
                                <div class="movie-details" style="margin-bottom: 15px; font-size: 14px; color: var(--text-muted);">
                                    <p style="margin: 5px 0;"><strong>ç‰‡é•·ï¼š</strong><?php echo htmlspecialchars($movie['movieTime']); ?></p>
                                    <p style="margin: 5px 0;"><strong>é¡å‹ï¼š</strong><?php echo htmlspecialchars($movie['movieTypeName']); ?></p>
                                    <p style="margin: 5px 0;"><strong>å°æ¼”ï¼š</strong><?php echo htmlspecialchars($movie['director']); ?></p>
                                    <p style="margin: 5px 0;"><strong>ä¸»æ¼”ï¼š</strong><?php echo htmlspecialchars(mb_substr($movie['actors'], 0, 30)); ?><?php echo mb_strlen($movie['actors']) > 30 ? '...' : ''; ?></p>
                                    <p style="margin: 5px 0;"><strong>ä¸Šæ˜ ï¼š</strong><?php echo htmlspecialchars($movie['movieStart']); ?></p>
                                </div>
                                
                                <div class="movie-actions" style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <a href="movie_detail.php?id=<?php echo $movie['movieId']; ?>" class="btn btn-info" style="flex: 1; text-align: center; font-size: 12px; padding: 8px;">
                                        è©³ç´°è³‡è¨Š
                                    </a>
                                    <a href="showings.php?movie=<?php echo $movie['movieId']; ?>" class="btn btn-secondary" style="flex: 1; text-align: center; font-size: 12px; padding: 8px;">
                                        æŸ¥çœ‹å ´æ¬¡
                                    </a>
                                    <a href="../booking/booking.php?movie=<?php echo $movie['movieId']; ?>" class="btn btn-primary" style="flex: 1; text-align: center; font-size: 12px; padding: 8px;">
                                        ç«‹å³è³¼ç¥¨
                                    </a>
                                </div>
                            </div>
                        </div>
                    <?php endwhile; ?>
                </div>
            <?php else: ?>
                <div class="text-center" style="padding: 60px 20px;">
                    <div style="font-size: 64px; margin-bottom: 20px; opacity: 0.3;">ğŸ¬</div>
                    <h3 class="text-muted">ç›®å‰æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„é›»å½±</h3>
                    <p class="text-muted">è«‹å˜—è©¦èª¿æ•´æœå°‹æ¢ä»¶æˆ–ç¨å¾Œå†è©¦</p>
                    <button class="btn btn-primary" onclick="location.href='movies.php'" style="margin-top: 20px;">
                        æŸ¥çœ‹æ‰€æœ‰é›»å½±
                    </button>
                </div>
            <?php endif; ?>
        </div>
    </div>
    
    <!-- é å°¾ä½”ä½ç¬¦ -->
    <div id="footer-placeholder"></div>
    
    <!-- è¼‰å…¥æ ¸å¿ƒJavaScript -->
    <script src="/WeiYuCinema/static/js/script.js"></script>
    
    <script>
        // é›»å½±å¡ç‰‡æ‡¸åœæ•ˆæœ
        document.querySelectorAll('.movie-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
                this.style.boxShadow = '0 15px 35px rgba(0,0,0,0.6)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 8px 25px rgba(0,0,0,0.4)';
            });
        });
    </script>
</body>
</html>