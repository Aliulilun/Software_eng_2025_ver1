# 🔧 會員資料管理系統 (Member Change)

## 📋 功能概述

會員資料管理系統允許已登入的會員查看和修改個人資料，包括基本資料和密碼變更功能。

---

## ✨ 主要功能

### 1. **資料顯示**
- 📋 顯示目前會員完整資料
- 🔍 包含會員編號、姓名、電子信箱、手機、生日、付款帳號等

### 2. **基本資料修改**
- ✏️ 修改姓名、電子信箱、手機號碼
- 📅 修改生日
- 💳 修改付款帳號
- ✅ 即時表單驗證

### 3. **密碼變更**
- 🔐 需輸入目前密碼驗證身份
- 🔑 設定新密碼（需確認兩次）
- 🛡️ 密碼長度驗證（6-50字元）

---

## 🗂️ 檔案結構

```
member/profile/
├── profile.php                    # 主頁面（PHP邏輯）
├── update_profile.php             # 基本資料更新處理
├── update_password.php            # 密碼更新處理
└── templates/
    └── profile.html               # HTML模板
```

---

## 🔧 功能詳細說明

### 主頁面 (`profile.php`)
- **功能**：顯示會員資料和提供修改表單
- **驗證**：需登入才能存取
- **模板**：使用 `templates/profile.html`
- **資料來源**：從 `memberProfile` 表查詢

### 基本資料更新 (`update_profile.php`)
- **功能**：處理基本資料修改請求
- **驗證項目**：
  - 必填欄位檢查
  - 電子信箱格式驗證
  - 手機號碼格式（10位數字）
  - 生日格式驗證
  - 付款帳號格式（3英文+11數字）
  - 電子信箱和付款帳號唯一性檢查

### 密碼更新 (`update_password.php`)
- **功能**：處理密碼變更請求
- **驗證項目**：
  - 目前密碼正確性驗證
  - 新密碼與確認密碼一致性
  - 密碼長度驗證（6-50字元）

---

## 📊 資料庫結構

### 使用表格：`memberProfile`

| 欄位 | 類型 | 說明 | 驗證規則 |
|------|------|------|----------|
| `memberId` | varchar(10) | 會員編號 | 唯讀 |
| `memberName` | varchar(20) | 姓名 | 必填，最大20字元 |
| `member` | varchar(50) | 電子信箱 | 必填，Email格式，唯一 |
| `memberPwd` | varchar(50) | 密碼 | 6-50字元 |
| `memberPhone` | varchar(10) | 手機號碼 | 必填，10位數字 |
| `memberBirth` | varchar(10) | 生日 | 必填，YYYY-MM-DD格式 |
| `memberPayAccount` | varchar(14) | 付款帳號 | 必填，3英文+11數字，唯一 |
| `memberConfirm` | varchar(6) | 帳號狀態 | 唯讀 |
| `role_id` | int(11) | 角色ID | 唯讀 |

---

## 🎨 介面特色

### 響應式設計
- 📱 支援手機和桌面版本
- 🎯 清晰的表單佈局
- 🔄 即時表單驗證

### 使用者體驗
- ✅ 成功/錯誤訊息提示
- 🎨 現代化的視覺設計
- 📋 資料預填和格式化顯示

### 安全性
- 🔒 登入狀態檢查
- 🛡️ SQL Injection 防護
- ✨ XSS 防護（htmlspecialchars）
- 🔍 資料格式驗證

---

## 🚀 使用方式

### 1. **存取頁面**
```
http://localhost/WeiYuCinema/member/profile/profile.php
```

### 2. **修改基本資料**
1. 在「修改基本資料」區塊填寫新資料
2. 點擊「💾 更新基本資料」按鈕
3. 系統驗證後更新資料

### 3. **變更密碼**
1. 在「變更密碼」區塊輸入目前密碼
2. 輸入新密碼並確認
3. 點擊「🔑 更新密碼」按鈕

---

## ⚠️ 錯誤處理

### 常見錯誤訊息

| 錯誤代碼 | 訊息 | 解決方法 |
|----------|------|----------|
| `empty_fields` | 請填寫所有必填欄位 | 確保所有必填欄位都有填寫 |
| `invalid_email` | 電子信箱格式不正確 | 檢查Email格式 |
| `invalid_phone` | 手機號碼格式不正確 | 輸入10位數字 |
| `invalid_pay_account` | 付款帳號格式不正確 | 3個英文字母+11個數字 |
| `email_exists` | 此電子信箱已被使用 | 使用其他電子信箱 |
| `pay_account_exists` | 此付款帳號已被使用 | 使用其他付款帳號 |
| `current_password_wrong` | 目前密碼不正確 | 確認目前密碼 |
| `password_mismatch` | 新密碼與確認密碼不一致 | 確保兩次密碼輸入相同 |
| `password_length` | 密碼長度需介於6-50字元 | 調整密碼長度 |

---

## 🧪 測試資料

### 測試帳號
```
帳號：ming123@gmail.com
密碼：pw1234
```

### 測試步驟
1. **登入測試**：使用測試帳號登入
2. **資料顯示測試**：確認資料正確顯示
3. **基本資料修改測試**：
   - 修改姓名：王小明 → 王大明
   - 修改電子信箱：ming123@gmail.com → ming456@gmail.com
   - 修改手機：0912345678 → 0987654321
4. **密碼變更測試**：
   - 輸入目前密碼：pw1234
   - 設定新密碼：newpass123
5. **驗證測試**：
   - 測試無效的電子信箱格式
   - 測試重複的電子信箱
   - 測試錯誤的密碼格式

---

## 🔗 相關連結

- **會員首頁**：`../index.php`
- **登入頁面**：`../../auth/login.php`
- **儲值卡管理**：`../topup/index.php`
- **瀏覽功能**：`../browse/movies.php`

---

## 📝 開發注意事項

### 安全性考量
1. **密碼處理**：目前使用明文儲存，生產環境應使用 `password_hash()` 和 `password_verify()`
2. **Session 管理**：確保 session 安全性
3. **輸入驗證**：所有使用者輸入都需要驗證

### 未來改進
1. **密碼加密**：實作 bcrypt 密碼雜湊
2. **頭像上傳**：新增會員頭像功能
3. **操作日誌**：記錄資料修改歷史
4. **Email 驗證**：修改電子信箱時發送驗證信

---

**版本：** 1.0  
**更新日期：** 2025-12-04  
**功能狀態：** ✅ Member Change (M) 功能已完成  
**開發者：** 威宇影城開發團隊
